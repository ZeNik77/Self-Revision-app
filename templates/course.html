{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <form id="aiForm" class="card shadow-sm p-4">
    <h4 class="mb-3 text-primary">Talk to AI</h4>

    <div class="mb-3">
      <label for="aiInput" class="form-label">Your Prompt</label>
      <textarea id="aiInput" name="prompt" class="form-control" rows="4" placeholder="Ask the AI anything..."></textarea>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3">
      <button type="submit" id="submitBtn" class="btn btn-success">Submit</button>
      <span id="loadingText" class="text-muted d-none">
        ⏳ Generating...
      </span>
    </div>

    <div id="aiAnswerBox" class="d-none">
      <label class="form-label fw-bold">AI Response</label>
      <div id="aiAnswer" class="p-3 bg-light border rounded">ХУИ
      </div>
    </div>
  </form>
</div>


<script>
    $(document).ready(function() {
        $('#aiForm').on('submit', function(event) {
            event.preventDefault();
            $('#loadingText').removeClass('d-none');
            $.ajax({
                url: '{% url "sendMessage" %}',
                type: 'POST',
                data: {
                    'input': $('#aiInput').val(),
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(response) {
                    $('#loadingText').addClass('d-none');
                    $('#aiAnswerBox').removeClass('d-none');   
                    $('#aiAnswer').text(response.message);
                }
            });
        });
    });
</script>
{% endblock %}